import{c as e,j as r,B as s,T as a,d as t,i as l,A as o,F as i,s as n,C as c,h as d}from"./index-BtTxyVhS.js";import{b as u}from"./vendor-B0SxJBnB.js";import{a as h,I as x,S as p,A as j,b as m,c as v,d as g,e as f,f as b,g as y,h as C,D as P,i as S,j as w,k as z,P as k}from"./produtos.service-DX7ngikH.js";const A=e(r.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),I=e(r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),W=n(y)((({theme:e})=>({"&.MuiTableCell-head":{backgroundColor:e.palette.primary.main,color:e.palette.common.white,fontWeight:"bold"}}))),T=n(f)((({theme:e})=>({"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"&:hover":{backgroundColor:e.palette.action.selected}}))),$={descricao:"",valor:0,status:"Ativo"};function D(){var e,n,D;const[R,q]=u.useState([]),[E,M]=u.useState(""),[N,B]=u.useState(!1),[L,O]=u.useState(""),[V,_]=u.useState(0),[F,H]=u.useState(10),[G,J]=u.useState(!1),[K,Q]=u.useState($),[U,X]=u.useState(!1),[Y,Z]=u.useState(null),[ee,re]=u.useState({}),se=async()=>{try{B(!0),O("");const e={};E&&(e.descricao=E);const r=await k.listar(e);q(r),_(0)}catch(e){O(`Erro ao buscar produtos: ${e.message}`)}finally{B(!1)}};u.useEffect((()=>{const e=setTimeout((()=>{se()}),500);return()=>clearTimeout(e)}),[E]);const ae=()=>{J(!1),re({}),O("")},te=R.slice(V*F,V*F+F);return r.jsxs(s,{sx:{p:3},children:[r.jsx(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:r.jsx(a,{variant:"h4",component:"h1",sx:{color:"primary.main",fontWeight:"medium"},children:"Cadastro de Pulseiras"})}),r.jsx(t,{sx:{p:2,mb:3},children:r.jsxs(s,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",md:"row"}},children:[r.jsx(s,{sx:{flex:{xs:"1",md:"3"}},children:r.jsx(h,{fullWidth:!0,variant:"outlined",label:"Buscar por descrição",value:E,onChange:e=>M(e.target.value),InputProps:{startAdornment:r.jsx(x,{position:"start",children:r.jsx(p,{color:"action"})})}})}),r.jsx(s,{sx:{flex:{xs:"1",md:"1"}},children:r.jsx(l,{fullWidth:!0,variant:"contained",startIcon:r.jsx(j,{}),onClick:()=>{X(!1),Q({descricao:"",valor:0,status:"Ativo"}),Z(null),re({}),O(""),J(!0)},children:"Nova Pulseira"})})]})}),L&&r.jsx(o,{severity:"error",sx:{mb:2},children:L.replace(/produto/g,"pulseira")}),r.jsxs(t,{children:[r.jsx(i,{in:!N,timeout:N?0:1e3,children:r.jsx(m,{children:r.jsxs(v,{children:[r.jsx(g,{children:r.jsxs(f,{children:[r.jsx(W,{children:"ID"}),r.jsx(W,{children:"Descrição"}),r.jsx(W,{align:"right",children:"Valor"}),r.jsx(W,{align:"center",children:"Status"}),r.jsx(W,{align:"center",children:"Ações"})]})}),r.jsx(b,{children:N?r.jsx(f,{children:r.jsx(y,{colSpan:5,align:"center",sx:{py:3},children:r.jsx(c,{size:40})})}):te.length>0?te.map((e=>{return r.jsxs(T,{children:[r.jsx(y,{children:e.id_produto}),r.jsx(y,{children:e.descricao}),r.jsx(y,{align:"right",children:(s=e.valor,s.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))}),r.jsx(y,{align:"center",children:e.status}),r.jsxs(y,{align:"center",children:[r.jsx(d,{color:"primary",onClick:()=>(async e=>{X(!0),Q({descricao:e.descricao,valor:e.valor,status:e.status}),Z(e.id_produto),re({}),O(""),J(!0)})(e),size:"small",children:r.jsx(I,{})}),r.jsx(d,{color:"error",onClick:()=>(async e=>{var r,s;if(window.confirm("Tem certeza que deseja excluir este produto?"))try{B(!0),O(""),await k.excluir(e),se()}catch(a){let e="Erro ao excluir produto";(null==(s=null==(r=a.response)?void 0:r.data)?void 0:s.error)?e=a.response.data.error:a.message&&(e=a.message),O(e)}finally{B(!1)}})(e.id_produto),size:"small",children:r.jsx(A,{})})]})]},e.id_produto);var s})):r.jsx(f,{children:r.jsx(y,{colSpan:5,align:"center",children:"Nenhuma pulseira encontrada"})})})]})})}),r.jsx(C,{rowsPerPageOptions:[5,10,25,50],component:"div",count:R.length,rowsPerPage:F,page:V,onPageChange:(e,r)=>{_(r)},onRowsPerPageChange:e=>{H(parseInt(e.target.value,10)),_(0)},labelRowsPerPage:"Itens por página",labelDisplayedRows:({from:e,to:r,count:s})=>`${e}-${r} de ${s}`})]}),r.jsxs(P,{open:G,onClose:ae,maxWidth:"sm",fullWidth:!0,children:[r.jsx(S,{children:U?"Editar Pulseira":"Nova Pulseira"}),r.jsxs(w,{children:[r.jsx(s,{sx:{mt:2,mb:2},children:r.jsx(h,{fullWidth:!0,label:"Descrição",value:K.descricao,onChange:e=>Q((r=>({...r,descricao:e.target.value}))),error:!!ee.descricao,helperText:null==(e=ee.descricao)?void 0:e.replace(/produto/g,"pulseira"),required:!0,multiline:!0,rows:2,inputProps:{maxLength:200}})}),r.jsx(s,{sx:{mt:3},children:r.jsx(h,{fullWidth:!0,label:"Valor",type:"number",value:K.valor,onChange:e=>Q((r=>({...r,valor:Number(e.target.value)}))),InputProps:{startAdornment:r.jsx(x,{position:"start",children:"R$"})},error:!!ee.valor,helperText:null==(n=ee.valor)?void 0:n.replace(/produto/g,"pulseira"),required:!0,inputProps:{min:0,step:.01,max:99999999.99}})}),r.jsx(s,{sx:{mt:3},children:r.jsxs(h,{select:!0,fullWidth:!0,label:"Status",value:K.status,onChange:e=>Q((r=>({...r,status:e.target.value}))),error:!!ee.status,helperText:null==(D=ee.status)?void 0:D.replace(/produto/g,"pulseira"),required:!0,SelectProps:{native:!0},children:[r.jsx("option",{value:"Ativo",children:"Ativo"}),r.jsx("option",{value:"Inativo",children:"Inativo"})]})})]}),r.jsxs(z,{children:[r.jsx(l,{onClick:ae,children:"Cancelar"}),r.jsx(l,{onClick:async()=>{if((()=>{const e={};return K.descricao.trim()||(e.descricao="A descrição é obrigatória"),K.valor<=0&&(e.valor="O valor deve ser maior que zero"),K.status||(e.status="O status é obrigatório"),re(e),0===Object.keys(e).length})())try{B(!0),O("");const e={...K,valor:Number(K.valor.toFixed(2))};U&&Y?await k.atualizar(Y,e):await k.criar(e),ae(),se()}catch(e){O(`Erro ao ${U?"atualizar":"criar"} produto: ${e.message}`)}finally{B(!1)}},variant:"contained",disabled:N,children:N?r.jsx(c,{size:24}):"Salvar"})]})]})]})}export{D as default};
//# sourceMappingURL=Produtos-xxH7LGyO.js.map
