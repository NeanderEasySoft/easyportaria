import{c as e,j as s,B as r,T as a,d as t,i as l,A as i,F as o,s as n,C as c,h as d}from"./index-CO_xUdKM.js";import{b as u}from"./vendor-B0SxJBnB.js";import{a as h,I as x,S as p,A as j,b as m,c as g,d as v,e as f,f as b,g as y,h as C,D as P,i as S,j as w,k as z,P as k}from"./produtos.service-JqK6Iw0g.js";const A=e(s.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),I=e(s.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),W=n(y)((({theme:e})=>({"&.MuiTableCell-head":{backgroundColor:e.palette.primary.main,color:e.palette.common.white,fontWeight:"bold"}}))),T=n(f)((({theme:e})=>({"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"&:hover":{backgroundColor:e.palette.action.selected}}))),$={descricao:"",valor:0,status:"Ativo"};function D(){var e,n,D;const[R,E]=u.useState([]),[M,N]=u.useState(""),[q,B]=u.useState(!1),[L,V]=u.useState(""),[_,O]=u.useState(0),[F,H]=u.useState(10),[G,J]=u.useState(!1),[K,Q]=u.useState($),[U,X]=u.useState(!1),[Y,Z]=u.useState(null),[ee,se]=u.useState({}),re=async()=>{try{B(!0),V("");const e={};M&&(e.descricao=M);const s=await k.listar(e);E(s),O(0)}catch(e){V(`Erro ao buscar produtos: ${e.message}`)}finally{B(!1)}};u.useEffect((()=>{const e=setTimeout((()=>{re()}),500);return()=>clearTimeout(e)}),[M]);const ae=()=>{J(!1),se({}),V("")},te=R.slice(_*F,_*F+F);return s.jsxs(r,{sx:{p:3},children:[s.jsx(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:s.jsx(a,{variant:"h4",component:"h1",sx:{color:"primary.main",fontWeight:"medium"},children:"Cadastro de Pulseiras"})}),s.jsx(t,{sx:{p:2,mb:3},children:s.jsxs(r,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",md:"row"}},children:[s.jsx(r,{sx:{flex:{xs:"1",md:"3"}},children:s.jsx(h,{fullWidth:!0,variant:"outlined",label:"Buscar por descrição",value:M,onChange:e=>N(e.target.value),InputProps:{startAdornment:s.jsx(x,{position:"start",children:s.jsx(p,{color:"action"})})}})}),s.jsx(r,{sx:{flex:{xs:"1",md:"1"}},children:s.jsx(l,{fullWidth:!0,variant:"contained",startIcon:s.jsx(j,{}),onClick:()=>{X(!1),Q({descricao:"",valor:0,status:"Ativo"}),Z(null),se({}),V(""),J(!0)},children:"Nova Pulseira"})})]})}),L&&s.jsx(i,{severity:"error",sx:{mb:2},children:L.replace(/produto/g,"pulseira")}),s.jsxs(t,{children:[s.jsx(o,{in:!q,timeout:q?0:1e3,children:s.jsx(m,{children:s.jsxs(g,{children:[s.jsx(v,{children:s.jsxs(f,{children:[s.jsx(W,{children:"ID"}),s.jsx(W,{children:"Descrição"}),s.jsx(W,{align:"right",children:"Valor"}),s.jsx(W,{align:"center",children:"Status"}),s.jsx(W,{align:"center",children:"Ações"})]})}),s.jsx(b,{children:q?s.jsx(f,{children:s.jsx(y,{colSpan:5,align:"center",sx:{py:3},children:s.jsx(c,{size:40})})}):te.length>0?te.map((e=>{return s.jsxs(T,{children:[s.jsx(y,{children:e.id_produto}),s.jsx(y,{children:e.descricao}),s.jsx(y,{align:"right",children:(r=e.valor,r.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))}),s.jsx(y,{align:"center",children:e.status}),s.jsxs(y,{align:"center",children:[s.jsx(d,{color:"primary",onClick:()=>(async e=>{X(!0),Q({descricao:e.descricao,valor:e.valor,status:e.status}),Z(e.id_produto),se({}),V(""),J(!0)})(e),size:"small",children:s.jsx(I,{})}),s.jsx(d,{color:"error",onClick:()=>(async e=>{var s,r;if(window.confirm("Tem certeza que deseja excluir este produto?"))try{B(!0),V(""),await k.excluir(e),re()}catch(a){let e="Erro ao excluir produto";(null==(r=null==(s=a.response)?void 0:s.data)?void 0:r.error)?e=a.response.data.error:a.message&&(e=a.message),V(e)}finally{B(!1)}})(e.id_produto),size:"small",children:s.jsx(A,{})})]})]},e.id_produto);var r})):s.jsx(f,{children:s.jsx(y,{colSpan:5,align:"center",children:"Nenhuma pulseira encontrada"})})})]})})}),s.jsx(C,{rowsPerPageOptions:[5,10,25,50],component:"div",count:R.length,rowsPerPage:F,page:_,onPageChange:(e,s)=>{O(s)},onRowsPerPageChange:e=>{H(parseInt(e.target.value,10)),O(0)},labelRowsPerPage:"Itens por página",labelDisplayedRows:({from:e,to:s,count:r})=>`${e}-${s} de ${r}`})]}),s.jsxs(P,{open:G,onClose:ae,maxWidth:"sm",fullWidth:!0,children:[s.jsx(S,{children:U?"Editar Pulseira":"Nova Pulseira"}),s.jsxs(w,{children:[s.jsx(r,{sx:{mt:2,mb:2},children:s.jsx(h,{fullWidth:!0,label:"Descrição",value:K.descricao,onChange:e=>Q((s=>({...s,descricao:e.target.value}))),error:!!ee.descricao,helperText:null==(e=ee.descricao)?void 0:e.replace(/produto/g,"pulseira"),required:!0,multiline:!0,rows:2,inputProps:{maxLength:200}})}),s.jsx(r,{sx:{mt:3},children:s.jsx(h,{fullWidth:!0,label:"Valor",type:"number",value:K.valor,onChange:e=>Q((s=>({...s,valor:Number(e.target.value)}))),InputProps:{startAdornment:s.jsx(x,{position:"start",children:"R$"})},error:!!ee.valor,helperText:null==(n=ee.valor)?void 0:n.replace(/produto/g,"pulseira"),required:!0,inputProps:{min:0,step:.01,max:99999999.99}})}),s.jsx(r,{sx:{mt:3},children:s.jsxs(h,{select:!0,fullWidth:!0,label:"Status",value:K.status,onChange:e=>Q((s=>({...s,status:e.target.value}))),error:!!ee.status,helperText:null==(D=ee.status)?void 0:D.replace(/produto/g,"pulseira"),required:!0,SelectProps:{native:!0},children:[s.jsx("option",{value:"Ativo",children:"Ativo"}),s.jsx("option",{value:"Inativo",children:"Inativo"})]})})]}),s.jsxs(z,{children:[s.jsx(l,{onClick:ae,children:"Cancelar"}),s.jsx(l,{onClick:async()=>{if((()=>{const e={};return K.descricao.trim()||(e.descricao="A descrição é obrigatória"),K.status||(e.status="O status é obrigatório"),se(e),0===Object.keys(e).length})())try{B(!0),V("");const e={...K,valor:Number(K.valor.toFixed(2))};U&&Y?await k.atualizar(Y,e):await k.criar(e),ae(),re()}catch(e){V(`Erro ao ${U?"atualizar":"criar"} produto: ${e.message}`)}finally{B(!1)}},variant:"contained",disabled:q,children:q?s.jsx(c,{size:24}):"Salvar"})]})]})]})}export{D as default};
//# sourceMappingURL=Produtos-CZxtFxjj.js.map
